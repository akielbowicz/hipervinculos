#!/usr/bin/env bash
# build - Build the static site and search index
#
# Usage: /build
#
# This command:
# 1. Generates HTML pages from bookmarks.json
# 2. Builds Pagefind search index
# 3. Updates metadata statistics
#
# The generated files are ready to be committed and deployed.

set -euo pipefail

echo "ğŸ—ï¸  Building static site..."
echo ""

echo "ğŸ“„ Generating HTML pages from bookmarks..."
node scripts/generate-pages.js

echo ""
echo "ğŸ” Building Pagefind search index..."
npx pagefind --site .

echo ""
echo "ğŸ“Š Updating metadata statistics..."
node scripts/update-metadata.js

echo ""
echo "âœ… Build complete!"
echo ""
echo "Generated files:"
echo "  - pages/*.html (bookmark pages)"
echo "  - pagefind/ (search index)"
echo "  - data/metadata.json (updated stats)"
echo ""
echo "Next steps:"
echo "  - Review changes: git status"
echo "  - Test locally: just serve"
echo "  - Commit: git add . && git commit -m 'build: update site'"
